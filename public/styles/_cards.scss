$card-deck-margin: divide($grid-gutter-width, 4);

.card {
	
	// override height attribute
	.card-img-top, .card-img-bottom {
		height: auto;
	}
}

ul.card-deck {
	@extend .list-unstyled;
}

// When displaying lists as card decks, groups or columns 
// we need to unstyle list styling and restyle as .card-*
ul.card-deck, ol.card-deck {
	@extend .list-unstyled;
	@extend .card-deck;
}
ul.card-group, ol.card-group {
	@extend .list-unstyled;
	@extend .card-group;
}
ul.card-column, ol.card-column {
	@extend .list-unstyled;
	@extend .card-column;
}

// Whole card as a single ling
a.card {
	.card-body {
		color: $body-color;
	}
	&:hover {
		text-decoration: none;
		.card-title {
			color: $link-color;
		}
	}
}

.card-deck {
	// brought from Bootstrap 4
	.card {
		margin-bottom: $card-deck-margin;
	}
	// brought from Bootstrap 4
	@include media-breakpoint-up(sm) {
		display: flex;
		flex-flow: row wrap;
		margin-right: -$card-deck-margin;
		margin-left: -$card-deck-margin;

		.card {
			// Flexbugs #4: https://github.com/philipwalton/flexbugs#flexbug-4
			flex: 1 0 0%;
			margin-right: $card-deck-margin;
			margin-bottom: 0; // Override the default
			margin-left: $card-deck-margin;
		}
	}

	margin-left: 0 - $card-deck-margin;
	margin-right: 0 - $card-deck-margin;
	margin-bottom: $grid-gutter-width - ($card-deck-margin * 2);
	&--4 {
		flex-wrap: wrap;
		.card {
			flex-basis: calc(25% - #{$card-deck-margin*2});
			max-width: calc(25% - #{$card-deck-margin*2});
			margin-left: $card-deck-margin;
			margin-right: $card-deck-margin;
			margin-bottom: $card-deck-margin*2;
			@include media-breakpoint-down(lg){
				flex-basis: calc(33.33% - #{$card-deck-margin*2});
				max-width: calc(33.33% - #{$card-deck-margin*2});
			}
			@include media-breakpoint-down(md){
				flex-basis: calc(50% - #{$card-deck-margin*2});
				max-width: calc(50% - #{$card-deck-margin*2});
			}
			@include media-breakpoint-down(sm){
				flex-basis: 100%;
				max-width: 100%;
				min-height: 50vw;
			}
			@include media-breakpoint-up(xl){
				// if there are only 3 or 6 articles, place only 3 per line...
				&:nth-child(1):nth-last-child(6), &:nth-child(2):nth-last-child(5), &:nth-child(3):nth-last-child(4), &:nth-child(4):nth-last-child(3), &:nth-child(5):nth-last-child(2), &:nth-child(6):nth-last-child(1), &:nth-child(1):nth-last-child(3), &:nth-child(2):nth-last-child(2), &:nth-child(3):nth-last-child(1) {
					flex-basis: calc(33.33% - #{$card-deck-margin*2});
					max-width: calc(33.33% - #{$card-deck-margin*2});
				}
			}
		}
	}
}

// Controlled widths for card
.card-deck--sized {
	.card {
		// 2 cols on SM up
		@include media-breakpoint-up(sm){
			flex-shrink: 0;
			flex-grow: 0;
			flex-basis: calc(50% - #{$card-deck-margin} * 2);
			min-width: calc(50% - #{$card-deck-margin} * 2);
			margin-bottom: $card-deck-margin * 2;
		}
		// 3 cols on LG up
		@include media-breakpoint-up(lg){
			flex-basis: calc(33.333% - #{$card-deck-margin} * 2);
			min-width: calc(33.333% - #{$card-deck-margin} * 2);
		}
	}
}
